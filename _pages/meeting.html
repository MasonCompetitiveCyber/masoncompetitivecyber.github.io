---
layout: default
permalink: /meeting/
title: Meetings
description: "Mason CC Meetings"
---

<div class='row-fluid'>
  <h3>Meeting Info</h3>

  <div>
    <div id="next-meeting" hidden>
      The next meeting is <strong id="meeting-info"></strong>
      on <strong id="meeting-date"></strong>
      in <strong id="meeting-location"></strong>
      from <strong id="meeting-time"></strong>.
      <a id="meeting-register">RSVP</a>
    </div>
    <div id="meeting-no-scheduled" hidden>No future meetings are scheduled yet. Come back later!</div>
  </div>
  <div class="table-container">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Date</th>
          <th scope="col">Topic</th>
          <th scope="col">Time</th>
          <th scope="col">Location</th>
          <th scope="col">RSVP</th>
        </tr>
      </thead>
      <tbody id="meeting-table">
      </tbody>
    </table>
  </div>
  <div id='meetingcontent'></div><br />
  <h3>Future Competitions<div id="cdrop" style='padding-left: 3%' class="btn-group" aria-labelledby="dropdownMenuLink">
    </div><br><br></h3>
  <div id='competitionfield'></div>
</div>

<script>
  getJSON("/meeting/json", function (err, data) {
    var meetingTable = document.getElementById("meeting-table");
    data["meetings"].forEach(function (meeting) {
      time = meeting["to"]
      if (time.includes('pm')) {
        time = time.split('pm')[0]
        hour = time.split(':')[0]
        min = time.split(':')[1]
        hour = parseInt(hour) + 12
        time = hour + ":" + min
      } else {
        time = time.split('am')[0]
        hour = time.split(':')[0]
        min = time.split(':')[1]
        time = hour + ":" + min
      }

      row = meetingTable.insertRow();
      th = document.createElement("th");
      th.innerText = meeting["meetingDate"];
      th.scope = "row";
      row.appendChild(th);
      row.insertCell().appendChild(document.createTextNode(meeting["basictopic"]));
      row.insertCell().appendChild(document.createTextNode(meeting["from"].replaceAll(":00", "") + " to " + meeting["to"].replaceAll(":00", "")));
      row.insertCell().appendChild(document.createTextNode(meeting["location"]));
      rsvp_link = document.createElement('a');
      rsvp_link.href = meeting["rsvp"];
      rsvp_link.innerText = "RSVP";
      row.insertCell().appendChild(rsvp_link);

      var parsedDate = Date.parse(meeting["meetingDate"] + ' ' + meeting["year"] + ' ' + time);
      if (Date.now() > parsedDate) {
        row.classList.add("disabled");
      }
    });

    var found = data["meetings"].some(function (meeting) {
      time = meeting["to"]
      if (time.includes('pm')) {
        time = time.split('pm')[0]
        hour = time.split(':')[0]
        min = time.split(':')[1]
        hour = parseInt(hour) + 12
        time = hour + ":" + min
      } else {
        time = time.split('am')[0]
        hour = time.split(':')[0]
        min = time.split(':')[1]
        time = hour + ":" + min
      }

      var parsedDate = Date.parse(meeting["meetingDate"] + ' ' + meeting["year"] + ' ' + time)
      if (parsedDate > Date.now()) {
        document.getElementById("meeting-location").innerText = meeting["location"];
        document.getElementById("meeting-time").innerText = meeting["from"] + " to " + meeting["to"];
        document.getElementById("meeting-date").innerText = meeting["meetingDate"];
        document.getElementById("meeting-info").innerText = meeting["basictopic"];
        document.getElementById("meeting-register").innerText = "RSVP";
        document.getElementById("meeting-register").href = meeting["rsvp"];
        document.getElementById("next-meeting").hidden = false;
        return true;
      }
    });

    if (!found) {
      document.getElementById("meeting-no-scheduled").hidden = false;
    }
  });



  function readCompetition(id) {
    $.getJSON('/competition/json?nocache=' + (new Date()).getTime(), null, function (data) {
      console.log('JSON data loaded')
      entry = "<button type='button' class='btn btn-primary dropdown-toggle' id='compbutton' data-toggle='dropdown'>Click to select meeting<span class='caret'></span></button> <ul class='dropdown-menu' role='menu'>"
      $.each(data["competitions"], function (i, item) {
        if (id == item['id']) {
          $('#compbutton').html(item['name'] + '<span class=\'caret\'></span>')
          data = 'Name:  <b>' + item['name'] + '</b><br>Starts: <b>' + item['startDate'] + ' ' + item['startTime'] + '</b><br>Ends: <b>' + item['endDate'] + ' ' + item['endTime'] + '</b><br>Location: <b>' + item['location'] + '<br><a href="' + item['moreInfo'] + '">More info</a></b>'
          if (item['inviteonly']) {
            data += "<br />NOTE: This competition is invite-only.<br />Please note you are not promised a spot and<br />if you'd like to participate, you should stay aware with CC's announcements and communications."
          }
          $('#competitionfield').html(data)
        };

      })
    })
  };




  var newbit = 0;
  $.getJSON('/competition/json?nocache=' + (new Date()).getTime(), null, function (data) {
    entry = "<button type='button' class='btn btn-primary dropdown-toggle' id='compbutton' data-toggle='dropdown'>Click to pick competition<span class='caret'></span></button> <ul class='dropdown-menu' role='menu'>"
    $.each(data["competitions"], function (i, item) {
      console.log(Date.parse(item["endDate"] + ' ' + item["year"]))
      if (Date.now() - Date.parse(item["endDate"] + ' ' + item["year"] + ' ' + '23:59') < 0) {
        if (newbit == 0) {
          newbit = item['id']
        }
        if (item["cancelled"]) {
          entry = entry + "<li class='selectorbs cancelledmeeting'><a href=javascript:readCompetition(" + item['id'] + ")> Cancelled " + item["name"] + "</a></li>"
        } else {
          entry = entry + "<li class='selectorbs'><a href=javascript:readCompetition(" + item['id'] + ")>" + item["name"] + "</a></li>"
        }
      }
    });
    entry = entry + '</ul></button>'
    readCompetition(newbit)
    $("#cdrop").html(entry)
  });
</script>